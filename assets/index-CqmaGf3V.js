var st=Object.defineProperty;var M=n=>{throw TypeError(n)};var it=(n,t,e)=>t in n?st(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var g=(n,t,e)=>it(n,typeof t!="symbol"?t+"":t,e),x=(n,t,e)=>t.has(n)||M("Cannot "+e);var c=(n,t,e)=>(x(n,t,"read from private field"),e?e.call(n):t.get(n)),u=(n,t,e)=>t.has(n)?M("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),y=(n,t,e,i)=>(x(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),a=(n,t,e)=>(x(n,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();var S;const p=class p{static get isLocked(){return c(p,S)}static set isLocked(t){if(typeof t!="boolean"){console.error("Состояние isLocked должно быть булевым");return}y(p,S,t)}static lock(){if(p.isLocked)return;const t=window.scrollY;document.body.style.setProperty("--scrolledTop",`-${t}px`),document.body.classList.add("lock"),document.body.classList.remove("unlock"),p.isLocked=!0}static unlock(){if(!p.isLocked)return;document.body.classList.remove("lock"),document.body.classList.add("unlock");const t=parseInt(document.body.style.getPropertyValue("--scrolledTop"),10);window.scrollTo({top:-t,behavior:"instant"}),document.body.style.removeProperty("--scrolledTop"),p.isLocked=!1}};S=new WeakMap,u(p,S,!1);let O=p;var b,L,l,V,z,Y,Z,K,U,B;const m=class m{constructor(){u(this,l);u(this,b);u(this,L,new Map);y(this,b,document.querySelector("[data-js-modal-backdrop]")),a(this,l,V).call(this)}getOpenInstance(){for(const[t,e]of c(this,L).entries())if(e.isOpen)return[t,e];return[null,null]}open({src:t,type:e,isNeedShowBackdrop:i=!0,closeAfterDelay:s}={}){this.close();const r=a(this,l,Z).call(this,t,e);return r?(c(this,b)&&i&&c(this,b).classList.add(m.stateClasses.isOpen),r.classList.add(m.stateClasses.isOpen),c(this,L).set(r,{isOpen:!0,type:e}),a(this,l,U).call(this),s&&setTimeout(()=>this.close(r),s),r):null}close(t=null,{isNeedCloseBackdrop:e=!0}={}){const[i]=this.getOpenInstance(),s=t||i;if(!s)return;const r=c(this,L).get(s);r&&(e&&c(this,b)&&c(this,b).classList.remove(m.stateClasses.isOpen),s.classList.remove(m.stateClasses.isOpen),r.type==="html"&&document.body.removeChild(s),c(this,L).delete(s),a(this,l,B).call(this))}};b=new WeakMap,L=new WeakMap,l=new WeakSet,V=function(){document.addEventListener("click",t=>a(this,l,z).call(this,t)),document.addEventListener("keydown",t=>a(this,l,Y).call(this,t))},z=function(t){const e=t.target.closest(`[${m.attrs.modalClose}]`),i=t.target.closest(`[${m.attrs.triggerOpen}]`);if(i){const s=i.getAttribute(m.attrs.triggerOpen),r=i.getAttribute(m.attrs.modalType);s&&r?this.open({src:s,type:r}):console.error("Отсутствуют или некорректны атрибуты для открытия модального окна:",s,r)}else if(e)this.close();else{const[s]=this.getOpenInstance();s&&!s.contains(t.target)&&this.close()}},Y=function(t){t.key==="Escape"&&this.close()},Z=function(t,e){return e==="selector"?document.querySelector(t):e==="html"&&typeof t=="string"?a(this,l,K).call(this,t):(console.error("Неверный источник или тип модального окна:",t,e),null)},K=function(t){const e=document.createElement("div");return e.classList.add(m.stateClasses.baseClass),e.innerHTML=t,document.body.appendChild(e),e},U=function(){O.lock()},B=function(){O.unlock()},g(m,"stateClasses",{isOpen:"isOpen",baseClass:"modal"}),g(m,"attrs",{triggerOpen:"data-js-modal-open",modalType:"data-js-modal-type",modalClose:"data-js-modal-close"});let k=m;var v,G,$;const o=class o{constructor(){u(this,v);if(o.instance)return o.instance;this.inputs=document.querySelectorAll(`[${o.attrs.inputRequired}]`),a(this,v,G).call(this),o.instance=this}static getValidationForm(t){let e=!0;return[...t.elements].forEach(i=>{i.matches(`[${o.attrs.inputRequired}]`)&&!o.validateInput(i)&&(e=!1)}),e}static validateInput(t){var R;const e=t.getAttribute(o.attrs.inputRequired),i={name:()=>o.validateText(t.value),email:()=>o.validateEmail(t.value)},s={name:"Введите корректное имя",email:"Введите корректный адрес электронной почты",message:"Это поле обязательно для заполнения"},r=((R=i[e])==null?void 0:R.call(i))??o.validateText(t.value),d=s[e]||"Это поле обязательно для заполнения",f=t.closest(`[${o.attrs.row}]`),j=f==null?void 0:f.querySelector(`[${o.attrs.error}]`);return r?o.hideError(f,j,t):o.showError(f,j,d,t),r}static validateEmail(t){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t.trim())}static validateText(t){return t.trim()!==""}static showError(t,e,i,s){t&&t.classList.add(o.stateClasses.isInvalid),s&&s.classList.add("input--invalid"),e&&(e.textContent=i)}static hideError(t,e,i){t&&t.classList.remove(o.stateClasses.isInvalid),i&&i.classList.remove("input--invalid"),e&&(e.textContent="")}};v=new WeakSet,G=function(){document.addEventListener("blur",a(this,v,$),!0),document.addEventListener("focus",a(this,v,$),!0),document.addEventListener("input",a(this,v,$),!0)},$=function(t){const e=t.target.closest(`[${o.attrs.inputRequired}]`);if(!e)return;const i=e.getAttribute(o.attrs.inputRequiredMode);((i?i.trim().split(/\s*,\s*/):[]).includes(t.type)||t.type==="input")&&o.validateInput(e)},g(o,"instance",null),g(o,"attrs",{inputRequired:"data-js-input-required",inputRequiredMode:"data-js-input-required-mode",error:"data-js-error-msg",row:"data-js-validate-row"}),g(o,"stateClasses",{isInvalid:"isInvalid",isValid:"isValid"});let P=o;var T,w,q,A,h,J,Q,W,D;class F{constructor(t,e="POST",i={},s=null){u(this,h);u(this,T);u(this,w);u(this,q);u(this,A);y(this,T,t),y(this,w,e.toUpperCase()),y(this,q,i),y(this,A,s||new k)}static getConfig(t,e){return t._config||(t._config=JSON.parse(t.getAttribute(e.form))),t._config}async sendData(t,e,{showModalAfterSuccess:i,showModalAfterError:s,isResetAfterSuccess:r}){try{const d=await fetch(c(this,T),a(this,h,J).call(this,e));if(!d.ok)throw new Error(`Ошибка сети: ${d.status} ${d.statusText}`);const f=await d.json();return a(this,h,Q).call(this,t,i,r),f}catch(d){throw a(this,h,W).call(this,d,s),d}}}T=new WeakMap,w=new WeakMap,q=new WeakMap,A=new WeakMap,h=new WeakSet,J=function(t){const e={method:c(this,w),headers:{Accept:"application/json",...c(this,q)}};return c(this,w)!=="GET"&&(e.body=t),e},Q=function(t,e,i){i&&t.reset(),a(this,h,D).call(this,e,!1,2e3)},W=function(t,e){console.error("Ошибка при отправке данных:",t),a(this,h,D).call(this,e,!0,3e3)},D=function(t,e,i){t&&c(this,A).open({src:t,type:"selector",isNeedShowBackdrop:e,closeAfterDelay:i}),O.unlock()};var I,C,X,H;const E=class E{constructor(){u(this,C);u(this,I);g(this,"attrs",{form:"data-js-form"});if(E.instance)return E.instance;this.isSubmittingForms=new Set,y(this,I,new k),a(this,C,H).call(this),E.instance=this}};I=new WeakMap,C=new WeakSet,X=async function(t){const{target:e,submitter:i}=t;if(!e.hasAttribute(this.attrs.form)||e.tagName.toLowerCase()!=="form")return;if(this.isSubmittingForms.has(e)){t.preventDefault();return}const s=F.getConfig(e,this.attrs),{url:r,method:d="POST",showModalAfterSuccess:f,showModalAfterError:j,isNeedPreventDefault:R=!0,isNeedValidateBeforeSubmit:_,isResetAfterSuccess:tt=!0}=s;if(R&&t.preventDefault(),_&&!P.getValidationForm(e))return;this.isSubmittingForms.add(e),i.disabled=!0;const et=new F(r,d,{},c(this,I));try{await et.sendData(e,new FormData(e),{showModalAfterSuccess:f,showModalAfterError:j,isResetAfterSuccess:tt})}finally{this.isSubmittingForms.delete(e),i.disabled=!1}},H=function(){document.addEventListener("submit",t=>a(this,C,X).call(this,t),!0)},g(E,"instance");let N=E;document.addEventListener("DOMContentLoaded",()=>{new k,new N,new P});
