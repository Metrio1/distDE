var B=Object.defineProperty;var A=i=>{throw TypeError(i)};var Y=(i,e,t)=>e in i?B(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var c=(i,e,t)=>Y(i,typeof e!="symbol"?e+"":e,t),w=(i,e,t)=>e.has(i)||A("Cannot "+t);var q=(i,e,t)=>(w(i,e,"read from private field"),t?t.call(i):e.get(i)),y=(i,e,t)=>e.has(i)?A("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),S=(i,e,t,n)=>(w(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),d=(i,e,t)=>(w(i,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();var L;const u=class u{static get isLocked(){return q(u,L)}static set isLocked(e){if(typeof e!="boolean"){console.error("Состояние isLocked должно быть булевым");return}S(u,L,e)}static lock(){if(u.isLocked)return;const e=window.scrollY;document.body.style.setProperty("--scrolledTop",`-${e}px`),document.body.classList.add("lock"),document.body.classList.remove("unlock"),u.isLocked=!0}static unlock(){if(!u.isLocked)return;document.body.classList.remove("lock"),document.body.classList.add("unlock");const e=parseInt(getComputedStyle(document.body).getPropertyValue("--scrolledTop"),10);window.scrollTo({top:-e,behavior:"instant"}),document.body.style.removeProperty("--scrolledTop"),u.isLocked=!1}};L=new WeakMap,y(u,L,!1);let h=u;var m,T,j,P;const s=class s{constructor(){y(this,m);if(s.instance)return s.instance;s.backdrop=document.querySelector("[data-js-modal-backdrop]"),d(this,m,T).call(this),s.instance=this}static getOpenInstance(){for(const[e,t]of s.instances.entries())if(t.isOpen)return[e,t];return[null,null]}static open({src:e,type:t,isNeedShowBackdrop:n=!0,closeAfterDelay:r}={}){s.closeOpenInstance();let o;if(t==="selector")o=document.querySelector(e);else if(t==="html"&&typeof e=="string")o=s.createModal(e);else{console.error("Неверный источник или тип модального окна:",e,t);return}if(!o){console.error("Модальное окно не найдено:",e);return}s.backdrop&&n?s.backdrop.classList.add(s.stateClasses.isOpen):s.backdrop&&s.backdrop.classList.remove(s.stateClasses.isOpen),o.classList.add(s.stateClasses.isOpen),s.instances.set(o,{isOpen:!0,type:t}),s.scrollLock(),r&&setTimeout(()=>{s.closeOpenInstance()},r)}static createModal(e){const t=document.createElement("div");return t.classList.add(s.stateClasses.baseClass),t.innerHTML=e,document.body.appendChild(t),t}static closeOpenInstance({isNeedCloseBackdrop:e=!0}={}){const[t,n]=s.getOpenInstance();console.debug("Открытое окно:",[t,n]),t&&(e&&s.backdrop&&s.backdrop.classList.remove(s.stateClasses.isOpen),t.classList.remove(s.stateClasses.isOpen),n.type==="html"&&document.body.removeChild(t),s.instances.delete(t),s.scrollUnlock())}static scrollLock(){h.lock()}static scrollUnlock(){h.unlock()}};m=new WeakSet,T=function(){document.addEventListener("click",e=>d(this,m,j).call(this,e)),document.addEventListener("keydown",e=>d(this,m,P).call(this,e))},j=function(e){const t=e.target.closest(`[${s.attrs.modalClose}]`),n=e.target.closest(`[${s.attrs.triggerOpen}]`);if(n){const r=n.getAttribute(s.attrs.triggerOpen),o=n.getAttribute(s.attrs.modalType);r&&o?s.open({src:r,type:o}):console.error("Отсутствуют или некорректны атрибуты для открытия модального окна:",r,o)}else if(t)s.closeOpenInstance();else{const[r]=s.getOpenInstance();r&&!r.contains(e.target)&&s.closeOpenInstance()}},P=function(e){if(e.key==="Escape"){const[t]=s.getOpenInstance();t&&s.closeOpenInstance()}},c(s,"instance",null),c(s,"stateClasses",{isOpen:"isOpen",baseClass:"modal"}),c(s,"attrs",{triggerOpen:"data-js-modal-open",modalType:"data-js-modal-type",modalClose:"data-js-modal-close"}),c(s,"instances",new Map),c(s,"backdrop",null);let v=s;var p,$,k;const a=class a{constructor(){y(this,p);if(a.instance)return a.instance;this.inputs=document.querySelectorAll(`[${a.attrs.inputRequired}]`),d(this,p,$).call(this),a.instance=this}static getValidationForm(e){let t=!0;return[...e.elements].forEach(n=>{n.matches(`[${a.attrs.inputRequired}]`)&&!a.validateInput(n)&&(t=!1)}),t}static validateInput(e){const t=e.getAttribute(a.attrs.inputRequired),n=e.closest(`[${a.attrs.row}]`).querySelector(`[${a.attrs.error}]`),r=e.closest(`[${a.attrs.row}]`);let o,l="";switch(t){case"name":o=a.validateText(e.value),l="Введите корректное имя";break;case"email":o=a.validateEmail(e.value),l="Введите корректный адрес электронной почты";break;case"message":o=a.validateText(e.value),l="Это поле обязательно для заполнения";break;default:o=!0}return o?a.hideError(r,n,e):a.showError(r,n,l,e),o}static validateEmail(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e.trim())}static validateText(e){return e.trim()!==""}static showError(e,t,n,r){e&&e.classList.add(a.stateClasses.isInvalid),r&&r.classList.add("input--invalid"),t&&(t.textContent=n)}static hideError(e,t,n){e&&e.classList.remove(a.stateClasses.isInvalid),n&&n.classList.remove("input--invalid"),t&&(t.textContent="")}};p=new WeakSet,$=function(){document.addEventListener("blur",d(this,p,k),!0),document.addEventListener("focus",d(this,p,k),!0),document.addEventListener("input",d(this,p,k),!0)},k=function(e){const t=e.target.closest(`[${a.attrs.inputRequired}]`);if(!t)return;const n=t.getAttribute(a.attrs.inputRequiredMode),r=n?n.trim().replace(" ","").split(","):[];(e.type==="input"||r.includes(e.type))&&a.validateInput(t)},c(a,"instance",null),c(a,"attrs",{inputRequired:"data-js-input-required",inputRequiredMode:"data-js-input-required-mode",error:"data-js-error-msg",row:"data-js-validate-row"}),c(a,"stateClasses",{isInvalid:"isInvalid",isValid:"isValid"});let g=a;class Z{constructor(e,t="POST"){this.url=e,this.method=t}async send(e){return fetch(this.url,{method:this.method,body:e,headers:{Accept:"application/json"}}).then(t=>{if(!t.ok)throw new Error("Сетевой ответ не успешен");return t.json()})}}var b,N,R;const f=class f{constructor(){y(this,b);c(this,"attrs",{form:"data-js-form"});if(f.instance)return f.instance;d(this,b,R).call(this),f.instance=this}};b=new WeakSet,N=async function(e){const{target:t,submitter:n}=e;if(!t.hasAttribute(this.attrs.form)||t.tagName.toLowerCase()!=="form")return;const r=JSON.parse(t.getAttribute(this.attrs.form)),{url:o,method:l="POST",showModalAfterSuccess:C,showModalAfterError:I,isNeedPreventDefault:x=!0,isNeedValidateBeforeSubmit:D}=r;if(x&&e.preventDefault(),D&&!g.getValidationForm(t))return;n.disabled=!0;const V=new FormData(t),z=new Z(o,l);try{const O=await z.send(V);t.reset(),console.debug("Успешно:",O),C&&(v.open({src:C,type:"selector",isNeedShowBackdrop:!1,closeAfterDelay:2e3}),h.unlock())}catch(O){console.error("Ошибка при выполнении запроса:",O),I&&v.open({src:I,type:"selector",isNeedShowBackdrop:!0,closeAfterDelay:3e3}),h.unlock()}finally{n.disabled=!1}},R=function(){document.addEventListener("submit",e=>d(this,b,N).call(this,e),!0)},c(f,"instance");let E=f;document.addEventListener("DOMContentLoaded",()=>{new v,new E,new g});
