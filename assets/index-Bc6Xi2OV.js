var nt=Object.defineProperty;var Z=n=>{throw TypeError(n)};var at=(n,t,e)=>t in n?nt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var y=(n,t,e)=>at(n,typeof t!="symbol"?t+"":t,e),F=(n,t,e)=>t.has(n)||Z("Cannot "+e);var l=(n,t,e)=>(F(n,t,"read from private field"),e?e.call(n):t.get(n)),c=(n,t,e)=>t.has(n)?Z("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),m=(n,t,e,s)=>(F(n,t,"write to private field"),s?s.call(n,e):t.set(n,e),e),a=(n,t,e)=>(F(n,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();var S;const f=class f{static get isLocked(){return l(f,S)}static set isLocked(t){if(typeof t!="boolean"){console.error("Состояние isLocked должно быть булевым");return}m(f,S,t)}static lock(){if(f.isLocked)return;const t=window.scrollY;document.body.style.setProperty("--scrolledTop",`-${t}px`),document.body.classList.add("lock"),document.body.classList.remove("unlock"),f.isLocked=!0}static unlock(){if(!f.isLocked)return;document.body.classList.remove("lock"),document.body.classList.add("unlock");const t=parseInt(document.body.style.getPropertyValue("--scrolledTop"),10);window.scrollTo({top:-t,behavior:"instant"}),document.body.style.removeProperty("--scrolledTop"),f.isLocked=!1}};S=new WeakMap,c(f,S,!1);let C=f;var g,w,d,K,U,B,G,J,H,Q;const h=class h{constructor(){c(this,d);c(this,g);c(this,w,new Map);m(this,g,document.querySelector("[data-js-modal-backdrop]")),a(this,d,K).call(this)}getOpenInstance(){for(const[t,e]of l(this,w).entries())if(e.isOpen)return[t,e];return[null,null]}open({src:t,type:e,isNeedShowBackdrop:s=!0,closeAfterDelay:i}={}){this.close();const r=a(this,d,G).call(this,t,e);return r?(l(this,g)&&s&&l(this,g).classList.add(h.stateClasses.isOpen),r.classList.add(h.stateClasses.isOpen),l(this,w).set(r,{isOpen:!0,type:e}),a(this,d,H).call(this),i&&setTimeout(()=>this.close(r),i),r):null}close(t=null,{isNeedCloseBackdrop:e=!0}={}){const[s]=this.getOpenInstance(),i=t||s;if(!i)return;const r=l(this,w).get(i);r&&(e&&l(this,g)&&l(this,g).classList.remove(h.stateClasses.isOpen),i.classList.remove(h.stateClasses.isOpen),r.type==="html"&&document.body.removeChild(i),l(this,w).delete(i),a(this,d,Q).call(this))}};g=new WeakMap,w=new WeakMap,d=new WeakSet,K=function(){document.addEventListener("click",t=>a(this,d,U).call(this,t)),document.addEventListener("keydown",t=>a(this,d,B).call(this,t))},U=function(t){const e=t.target.closest(`[${h.attrs.modalClose}]`),s=t.target.closest(`[${h.attrs.triggerOpen}]`);if(s){const i=s.getAttribute(h.attrs.triggerOpen),r=s.getAttribute(h.attrs.modalType);i&&r?this.open({src:i,type:r}):console.error("Отсутствуют или некорректны атрибуты для открытия модального окна:",i,r)}else if(e)this.close();else{const[i]=this.getOpenInstance();i&&!i.contains(t.target)&&this.close()}},B=function(t){t.key==="Escape"&&this.close()},G=function(t,e){return e==="selector"?document.querySelector(t):e==="html"&&typeof t=="string"?a(this,d,J).call(this,t):(console.error("Неверный источник или тип модального окна:",t,e),null)},J=function(t){const e=document.createElement("div");return e.classList.add(h.stateClasses.baseClass),e.innerHTML=t,document.body.appendChild(e),e},H=function(){C.lock()},Q=function(){C.unlock()},y(h,"stateClasses",{isOpen:"isOpen",baseClass:"modal"}),y(h,"attrs",{triggerOpen:"data-js-modal-open",modalType:"data-js-modal-type",modalClose:"data-js-modal-close"});let A=h;var b,W,x;const o=class o{constructor(){c(this,b);if(o.instance)return o.instance;this.inputs=document.querySelectorAll(`[${o.attrs.inputRequired}]`),a(this,b,W).call(this),o.instance=this}static getValidationForm(t){let e=!0;return[...t.elements].forEach(s=>{s.matches(`[${o.attrs.inputRequired}]`)&&!o.validateInput(s)&&(e=!1)}),e}static isValidForm(t,e,s){return!t.hasAttribute(e.form)||!(t instanceof HTMLFormElement)?!1:!(s&&!o.getValidationForm(t))}static validateInput(t){var Y;const e=t.getAttribute(o.attrs.inputRequired),s={name:()=>o.validateText(t.value),email:()=>o.validateEmail(t.value)},i={name:"Введите корректное имя",email:"Введите корректный адрес электронной почты",message:"Это поле обязательно для заполнения"},r=((Y=s[e])==null?void 0:Y.call(s))??o.validateText(t.value),u=i[e]||"Это поле обязательно для заполнения",L=t.closest(`[${o.attrs.row}]`),z=L==null?void 0:L.querySelector(`[${o.attrs.error}]`);return r?o.hideError(L,z,t):o.showError(L,z,u,t),r}static validateEmail(t){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t.trim())}static validateText(t){return t.trim()!==""}static showError(t,e,s,i){t&&t.classList.add(o.stateClasses.isInvalid),i&&i.classList.add("input--invalid"),e&&(e.textContent=s)}static hideError(t,e,s){t&&t.classList.remove(o.stateClasses.isInvalid),s&&s.classList.remove("input--invalid"),e&&(e.textContent="")}};b=new WeakSet,W=function(){document.addEventListener("blur",a(this,b,x),!0),document.addEventListener("focus",a(this,b,x),!0),document.addEventListener("input",a(this,b,x),!0)},x=function(t){const e=t.target.closest(`[${o.attrs.inputRequired}]`);if(!e)return;const s=e.getAttribute(o.attrs.inputRequiredMode);((s?s.trim().split(/\s*,\s*/):[]).includes(t.type)||t.type==="input")&&(e.getAttribute(o.attrs.inputRequired)==="email"?(clearTimeout(e.emailValidationTimeout),e.emailValidationTimeout=setTimeout(()=>{o.validateInput(e)},300)):o.validateInput(e))},y(o,"instance",null),y(o,"attrs",{inputRequired:"data-js-input-required",inputRequiredMode:"data-js-input-required-mode",error:"data-js-error-msg",row:"data-js-validate-row"}),y(o,"stateClasses",{isInvalid:"isInvalid",isValid:"isValid"});let M=o;var q,O,I,R,p,X,_,tt,D;class lt{constructor(t,e="POST",s={},i=null){c(this,p);c(this,q);c(this,O);c(this,I);c(this,R);m(this,q,t),m(this,O,e.toUpperCase()),m(this,I,s),m(this,R,i||new A)}async sendData(t,e,{showModalAfterSuccess:s,showModalAfterError:i,isResetAfterSuccess:r}){try{const u=await fetch(l(this,q),a(this,p,X).call(this,e));if(!u.ok)throw new Error(`Ошибка сети: ${u.status} ${u.statusText}`);const L=await u.json();return a(this,p,_).call(this,t,s,r),L}catch(u){throw a(this,p,tt).call(this,u,i),u}}}q=new WeakMap,O=new WeakMap,I=new WeakMap,R=new WeakMap,p=new WeakSet,X=function(t){const e={method:l(this,O),headers:{Accept:"application/json",...l(this,I)}};return l(this,O)!=="GET"&&(e.body=t),e},_=function(t,e,s){s&&t.reset(),a(this,p,D).call(this,e,!1,2e3)},tt=function(t,e){console.error("Ошибка при отправке данных:",t),a(this,p,D).call(this,e,!0,3e3)},D=function(t,e,s){t&&l(this,R).open({src:t,type:"selector",isNeedShowBackdrop:e,closeAfterDelay:s}),C.unlock()};var P,k,j,T,et,st;class ct{constructor(t,e=null){c(this,T);c(this,P);c(this,k,new Set);c(this,j);m(this,P,t),m(this,j,e)}async process(t,e,s){if(l(this,k).has(t))return;a(this,T,et).call(this,t,e);const i=l(this,j)||new lt(s.url,s.method,{},l(this,P));try{await i.sendData(t,new FormData(t),{showModalAfterSuccess:s.showModalAfterSuccess,showModalAfterError:s.showModalAfterError,isResetAfterSuccess:s.isResetAfterSuccess})}finally{a(this,T,st).call(this,t,e)}}}P=new WeakMap,k=new WeakMap,j=new WeakMap,T=new WeakSet,et=function(t,e){l(this,k).add(t),e.disabled=!0},st=function(t,e){l(this,k).delete(t),e.disabled=!1};var V,$,v,it,rt,ot;const E=class E{constructor(t=new A,e=null,s=null){c(this,v);c(this,V);c(this,$);y(this,"attrs",{form:"data-js-form"});if(E.instance)return E.instance;m(this,V,t),m(this,$,e||new ct(t,s)),a(this,v,ot).call(this),E.instance=this}};V=new WeakMap,$=new WeakMap,v=new WeakSet,it=async function(t){const{target:e,submitter:s}=t,i=a(this,v,rt).call(this,e),{isNeedPreventDefault:r=!0,isNeedValidateBeforeSubmit:u=!0}=i;r&&t.preventDefault(),M.isValidForm(e,this.attrs,u)&&await l(this,$).process(e,s,i)},rt=function(t){return t._config||(t._config=JSON.parse(t.getAttribute(this.attrs.form))),t._config},ot=function(){document.addEventListener("submit",t=>a(this,v,it).call(this,t),!0)},y(E,"instance");let N=E;document.addEventListener("DOMContentLoaded",()=>{new A,new N,new M});
